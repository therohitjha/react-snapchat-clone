{"version":3,"sources":["AppShell/store.ts","utils/animation.ts","utils/audio.ts","utils/browser.ts","utils/system.ts","utils/state.ts","features/Camera/store.ts","features/User/store.ts","features/SnapMap/data.ts","features/SnapMap/store.ts","features/SnapMap/utils.ts","features/Snap/store.ts","features/Chat/store.ts","common/Icon/index.tsx","common/Button/index.tsx","common/Input/index.tsx","common/Header/index.tsx","AppShell/utils.ts","AppShell/Toolbar/index.tsx","common/Widget/index.tsx","common/Pod/ActionItem/index.tsx","common/Loader/index.tsx","features/Account/Map/index.tsx","features/Account/index.tsx","common/Avatar/index.tsx","common/Pod/User/index.tsx","common/Error/index.tsx","features/Search/index.tsx","utils/string.ts","features/SnapMap/Header/index.tsx","features/SnapMap/index.tsx","features/Snap/index.tsx","utils/time.ts","features/Archive/index.tsx","features/Chat/data.ts","common/Pill/index.tsx","features/Chat/index.tsx","utils/array.ts","common/SkeletonFrame/index.tsx","common/Pod/Spotlight/index.tsx","features/Discover/index.tsx","utils/viewport.ts","AppShell/Drawer/index.tsx","AppShell/Footer/index.tsx","AppShell/index.tsx","features/Camera/PhotoCapture/index.tsx","features/Camera/index.tsx","features/404/index.tsx","index.tsx"],"names":["appSlice","createSlice","name","initialState","drawers","footerType","reducers","showDrawer","reducer","state","action","drawer","payload","minusCurrentDrawer","filter","component","prepare","animationIn","animationOut","animationInDuration","animationOutDuration","theme","position","show","hideDrawer","map","hideAllDrawers","openDrawers","lastDrawerOpen","length","setFooterType","actions","onAnimationComplete","callback","setTimeout","playSound","sound","audioElem","a","soundMap","newAppMessage","cameraShutter","src","play","navigator","language","api","baseURL","get","endpoint","external","respond","post","options","put","patch","delete","method","data","url","headers","Headers","body","JSON","stringify","fetch","response","json","promise","then","Error","catch","err","sleep","milliseconds","Promise","resolve","loadable","loading","error","cameraMode","photoTaken","photos","getPhotos","createAsyncThunk","cameraSlice","setPhoto","time","dataURL","images","unshift","month","toLocaleString","year","getFullYear","Date","toggleCameraMode","extraReducers","builder","addCase","pending","fulfilled","rejected","session","id","username","avatar","gender","age","fullName","geolocation","country","city","zip","latitude","longitude","friends","getSession","getFriends","getGeoLocation","country_name","postal","userSlice","setLatLon","abbrConditionMap","sn","sl","h","t","s","c","hr","lr","hc","lc","conditionIconMap","snow","sleet","hail","thunderstorm","showers","clear","getSnaps","lat","lon","coords","snaps","snap","index","location","getWeather","weather","temperature","condition","whereOnEarthID","woeid","consolidated_weather","the_temp","weather_state_abbr","celsius","Math","round","snapMapSlice","defaultSnap","type","caption","shareable","snapSlice","addSnap","removeSnap","thread","messages","getMessages","user","chatSlice","postMessage","author","message","push","uuid","iconMap","faSnapchatSquare","faGithub","faCircle","faCamera","faUserPlus","faListAlt","faGrinBeam","faAngleRight","faCompass","faUserCircle","faSearch","faRetweet","faAngleDown","faLocationArrow","faSignal","faBatteryHalf","faCommentAlt","faMobile","faMobileAlt","faDot","faLaugh","faSmileWink","faEllipsisV","faEllipsisH","faCog","faTimesCircle","faTimes","faAngleLeft","faSearchPlus","faPaw","faSpider","faWater","faPhoneAlt","faVideo","faRocket","faMicrophone","faDownload","faTextHeight","faPen","faStickyNote","faCut","faPaperclip","faCropAlt","faStopwatch","faExternalLinkAlt","faPlayCircle","faEdit","faMagic","faQrcode","faSnowflake","faIcicles","faCloudMeatball","faPooStorm","faCloudShowersHeavy","faCloudRain","faCloud","faCloudSun","faSun","faExclamationCircle","Icon","icon","onClick","className","classNames","Button","image","icons","iconClass","iconClasses","buttonClass","plain","purple","label","onclick","testId","data-test","alt","key","Input","placeholder","value","leftIcon","rightIcon","onFocus","onBlur","onChange","onEnter","focus","spellCheck","animate","dark","inputElem","useRef","useState","full","setFull","useEffect","current","disabled","ref","onKeyPress","Header","insideDrawer","dispatch","useDispatch","useSelector","iconImage","atleastOneDrawerOpen","some","Toolbar","app","setTime","updateTime","toLocaleTimeString","hour","minute","replace","setInterval","Widget","header","children","transparent","ActionItem","straightEdge","Loader","fixed","nobg","Array","fill","val","apiKey","process","REACT_APP_MAP_BOX_API_KEY","hasApiKey","mapboxgl","accessToken","Map","mapElem","setLoading","loadMap","dummyResponse","getCurrentPosition","maximumAge","Infinity","timeout","enableHighAccuracy","container","style","center","zoom","interactive","on","tooltip","document","createElement","Marker","setLngLat","addTo","role","aria-label","href","target","rel","currentDate","toLocaleDateString","day","Account","title","sizeMap","sm","md","lg","Avatar","size","width","User","Search","query","setQuery","pattern","RegExp","users","match","hasResults","e","currentTarget","isVisible","snapMap","SnapMap","setMap","classList","add","Popup","closeOnClick","setHTML","addSelfMarker","flyTo","marker","setAttribute","remove","addSnapToMap","Snap","videoElem","load","closeSnap","metadata","timestamp","formatter","Intl","RelativeTimeFormat","numeric","ms","now","years","ceil","format","months","days","hours","minutes","seconds","relativeTime","playsInline","onEnded","Archive","camera","openPhoto","dummyMessages","Pill","Chat","chat","messageContainer","setMessage","typing","setTyping","useLayoutEffect","scrollTop","scrollHeight","botResponse","useCallback","firstMsg","typeAndStop","i","prevTyping","arr","floor","random","submitMessage","other","SkeletonFrame","count","Spotlight","Discover","drawerContent","loadMore","isFetching","onScroll","func","wait","args","later","clearTimeout","debounce","elem","fullyVisible","getBoundingClientRect","elemTop","top","elemBottom","bottom","window","innerHeight","elemInView","setPage","prevPage","page","profiles","setProfiles","addEventListener","prevProfiles","discover","removeEventListener","Drawer","getElementById","height","account","search","archive","getComponent","Footer","animateOnMount","AppShell","PhotoCapture","takePic","closePic","canvasElem","documentElement","viewportHeight","setProperty","stretchViewPortHeight","getDataURL","toDataURL","innerWidth","context","getContext","canvas","drawImage","takePhoto","hide","test","userAgent","MSStream","open","link","download","click","defaultFilters","Camera","showFilterButtons","setShowFilterButtons","filters","setFilters","activeFilter","setActiveFilter","filterInitialized","setFilterInitialized","cameraStream","setCameraStream","setTakePic","notSupported","setNotSupported","startCamera","maxWidth","querySelector","offsetWidth","mediaDevices","getUserMedia","constraints","webkitGetUserMedia","mozGetUserMedia","reject","call","video","facingMode","ideal","srcObject","Filters","init","getTracks","forEach","track","stop","setActiveFilterButton","selectFilter","newFilters","splice","switchFilter","JEEFACEFILTERAPI","destroy","includes","muted","autoPlay","NotFound","to","store","configureStore","App","StrictMode","path","exact","ReactDOM","render"],"mappings":"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","file":"static/js/main.78675b4e.chunk.js","sourcesContent":["import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { DrawerComponent, Drawer, FooterType } from 'AppShell/types';\n\nconst initialState: {\n  drawers: Drawer[];\n  footerType: FooterType;\n} = {\n  drawers: [],\n  footerType: 'full'\n};\n\nconst appSlice = createSlice({\n  name: 'app',\n  initialState,\n  reducers: {\n    showDrawer: {\n      reducer(state, action: PayloadAction<Drawer>) {\n        const drawer = action.payload;\n        const minusCurrentDrawer = state.drawers.filter(\n          ({ component }) => component !== drawer.component\n        );\n        state.drawers = [...minusCurrentDrawer, drawer];\n      },\n      prepare(drawer: Drawer) {\n        const drawerDefaults = {\n          animationIn: 'slideInUp',\n          animationOut: 'slideOutDown',\n          animationInDuration: 300,\n          animationOutDuration: 300,\n          theme: 'light',\n          position: 'front',\n          show: true\n        } as Drawer;\n        return {\n          payload: {\n            ...drawerDefaults,\n            ...drawer\n          }\n        };\n      }\n    },\n    hideDrawer(state, action: PayloadAction<DrawerComponent>) {\n      const component = action.payload;\n      state.drawers = state.drawers.map((drawer) => {\n        if (drawer.component === component)\n          return {\n            ...drawer,\n            show: false\n          };\n        return drawer;\n      });\n    },\n    hideAllDrawers(state) {\n      const openDrawers = state.drawers.filter(({ show }) => show);\n      const lastDrawerOpen = openDrawers[openDrawers.length - 1].component;\n      let drawers;\n\n      // If only 1 drawer is open just close it\n      if (openDrawers.length === 1) {\n        drawers = state.drawers.map((drawer) => ({\n          ...drawer,\n          show: false\n        }));\n      }\n      // If more than 1 drawer is open, close them all but show exit animation only on the last opened one\n      else {\n        drawers = state.drawers.map((drawer) => {\n          if (drawer.component === lastDrawerOpen)\n            return {\n              ...drawer,\n              show: false\n            };\n          return {\n            ...drawer,\n            show: false,\n            animationOutDuration: 0\n          };\n        });\n      }\n\n      state.drawers = drawers;\n    },\n    setFooterType(state, action: PayloadAction<FooterType>) {\n      state.footerType = action.payload;\n    }\n  }\n});\n\nexport const { showDrawer, hideDrawer, hideAllDrawers, setFooterType } = appSlice.actions;\n\nexport default appSlice.reducer;\n","// Run a callback function after an animation transition is complete\n// This is to prevent frame choppiness which happens if running too many things at once during the animation\n// 300ms is the default animation in and out duration on drawers so it's also the default here\nexport const onAnimationComplete = (callback, animationInDuration = 300) =>\n  setTimeout(callback, animationInDuration);\n","export const playSound = async (sound: string, audioElem: HTMLAudioElement) => {\n  const soundMap = {\n    newAppMessage: './audio/blip.mp3',\n    cameraShutter: './audio/shutter.mp3'\n  };\n  // IOS no longer allows sounds to be played without a user action\n  // passing an audio tag from the component and setting it's `src` attribute\n  // and then paying it seems to bypass this restriction for now..\n  audioElem.src = soundMap[sound];\n  try {\n    await audioElem.play();\n  } catch (err) {}\n};\n","export const { language = 'en-US' } = navigator;\n\nexport const isIOS = () =>\n  /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\n","export const api = {\n  baseURL: './api',\n  get: (endpoint, external = false) => api.respond('get', endpoint, null, external),\n  post: (endpoint, options) => api.respond('post', endpoint, options),\n  put: (endpoint, options) => api.respond('put', endpoint, options),\n  patch: (endpoint, options) => api.respond('patch', endpoint, options),\n  delete: (endpoint) => api.respond('delete', endpoint),\n  respond: async (method, endpoint, data?, external?) => {\n    const url = external ? endpoint : api.baseURL + endpoint;\n    const options = data\n      ? {\n          headers: new Headers({ 'Content-Type': 'application/json' }),\n          body: JSON.stringify(data)\n        }\n      : {};\n    try {\n      const response = await fetch(url, { method, ...options });\n      const data = await response.json();\n      return [null, data];\n    } catch (error) {\n      return [error];\n    }\n  }\n};\n\n// https://gist.github.com/DavidWells/54f9dd1af4a489e5f1358f33ce59e8ad\nexport const promise = (promise: Promise<[boolean, any]>) =>\n  promise\n    .then((data) => {\n      if (data instanceof Error) return [data];\n      return [null, data];\n    })\n    .catch((err) => [err]);\n\n// https://levelup.gitconnected.com/debounce-in-javascript-improve-your-applications-performance-5b01855e086\nexport const debounce = (func, wait) => {\n  let timeout;\n  return function executedFunction(...args) {\n    const later = () => {\n      timeout = null;\n      func(...args);\n    };\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n  };\n};\n\nexport const sleep = (milliseconds) =>\n  new Promise((resolve) => setTimeout(resolve, milliseconds));\n","export const loadable = {\n  loading: false,\n  error: false,\n  data: []\n};\n","import { createSlice, createAsyncThunk, PayloadAction } from '@reduxjs/toolkit';\nimport { api, loadable } from 'utils';\nimport { Loadable } from 'types';\nimport { Photos, CameraMode } from './types';\n\nconst initialState: {\n  cameraMode: CameraMode;\n  photoTaken: boolean;\n  photos: Loadable<Photos>;\n} = {\n  cameraMode: 'user',\n  photoTaken: false,\n  photos: loadable\n};\n\nexport const getPhotos = createAsyncThunk('photos/getPhotos', async () => {\n  const [error, response] = await api.get('/photos.json');\n  if (!error) return response.photos;\n});\n\nconst cameraSlice = createSlice({\n  name: 'photos',\n  initialState,\n  reducers: {\n    setPhoto: {\n      reducer(state, action: PayloadAction<{ time: Date; dataURL: string }>) {\n        const { time, dataURL } = action.payload;\n        if (state.photoTaken) {\n          state.photos[0].data.images.unshift(action.payload.dataURL);\n        } else {\n          state.photoTaken = true;\n          state.photos.data.unshift({\n            month: time.toLocaleString('default', { month: 'long' }),\n            year: time.getFullYear(),\n            images: [dataURL]\n          });\n        }\n      },\n      prepare(dataURL: string) {\n        return {\n          payload: {\n            dataURL,\n            time: new Date()\n          }\n        };\n      }\n    },\n    toggleCameraMode(state) {\n      state.cameraMode = state.cameraMode === 'user' ? 'environment' : 'user';\n    }\n  },\n  extraReducers: (builder) => {\n    builder.addCase(getPhotos.pending, ({ photos }) => {\n      photos.loading = true;\n    });\n    builder.addCase(getPhotos.fulfilled, ({ photos }, { payload }) => {\n      photos.loading = false;\n      if (payload) photos.data = payload;\n      else photos.error = true;\n    });\n    builder.addCase(getPhotos.rejected, ({ photos }) => {\n      photos.loading = false;\n      photos.error = true;\n    });\n  }\n});\n\nexport const { setPhoto, toggleCameraMode } = cameraSlice.actions;\n\nexport default cameraSlice.reducer;\n","import { createSlice, createAsyncThunk, PayloadAction } from '@reduxjs/toolkit';\nimport { api, loadable } from 'utils';\nimport { Loadable } from 'types';\nimport { User, Geolocation } from './types';\n\nconst initialState: {\n  session: User;\n  geolocation: Geolocation;\n  friends: Loadable<User[]>;\n} = {\n  session: {\n    id: '',\n    username: '',\n    avatar: '',\n    gender: 'other',\n    age: 0,\n    fullName: ''\n  },\n  geolocation: {\n    country: '',\n    state: '',\n    city: '',\n    zip: '',\n    latitude: 0,\n    longitude: 0\n  },\n  friends: loadable\n};\n\nexport const getSession = createAsyncThunk('user/sessionFetched', async () => {\n  const [error, response] = await api.get('/session.json');\n  if (error) return false;\n  return response.session;\n});\n\nexport const getFriends = createAsyncThunk('user/friendsFetched', async () => {\n  const [error, response] = await api.get('/friends.json');\n  if (error) return false;\n  return response.friends;\n});\n\nexport const getGeoLocation = createAsyncThunk('user/geoLocationFetched', async () => {\n  const [error, response] = await api.get('https://geolocation-db.com/json/', true);\n\n  if (error) return false;\n\n  const { country_name, state, city, postal, latitude, longitude } = response;\n\n  return {\n    country: country_name,\n    state,\n    city,\n    zip: postal,\n    latitude,\n    longitude\n  };\n});\n\nconst userSlice = createSlice({\n  name: 'user',\n  initialState,\n  reducers: {\n    setLatLon(state, action: PayloadAction<{ latitude: number; longitude: number }>) {\n      const { geolocation } = state;\n      const { latitude, longitude } = action.payload;\n      geolocation.latitude = latitude;\n      geolocation.longitude = longitude;\n    }\n  },\n  extraReducers: (builder) => {\n    builder.addCase(getSession.fulfilled, (state, { payload }) => {\n      if (payload) state.session = payload;\n    });\n    builder.addCase(getGeoLocation.fulfilled, (state, { payload }) => {\n      if (payload) state.geolocation = payload;\n    });\n    builder.addCase(getFriends.pending, ({ friends }) => {\n      friends.loading = true;\n    });\n    builder.addCase(getFriends.fulfilled, ({ friends }, { payload }) => {\n      friends.loading = false;\n      if (payload) friends.data = payload;\n      else friends.error = true;\n    });\n    builder.addCase(getFriends.rejected, ({ friends }) => {\n      friends.loading = false;\n      friends.error = true;\n    });\n  }\n});\n\nexport const { setLatLon } = userSlice.actions;\n\nexport default userSlice.reducer;\n","export const abbrConditionMap = {\n  sn: 'snow',\n  sl: 'sleet',\n  h: 'hail',\n  t: 'thunderstorm',\n  s: 'showers',\n  c: 'clear',\n  hr: 'heavy-rain',\n  lr: 'light-rain',\n  hc: 'heavy-cloud',\n  lc: 'light-cloud'\n};\n\nexport const conditionIconMap = {\n  snow: 'faSnowflake',\n  sleet: 'faIcicles',\n  hail: 'faCloudMeatball',\n  thunderstorm: 'faPooStorm',\n  showers: 'faCloudShowersHeavy',\n  clear: 'faSun',\n  'heavy-rain': 'faCloudShowersHeavy',\n  'light-rain': 'faCloudRain',\n  'heavy-cloud': 'faCloud',\n  'light-cloud': 'faCloudSun'\n};\n","import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport { api } from 'utils';\nimport { celsiusToFahrenheit } from './utils';\nimport { Snap } from 'features/Snap/types';\nimport { Weather } from './types';\nimport { abbrConditionMap } from './data';\n\nconst initialState: {\n  snaps: Snap[];\n  weather: Weather;\n} = {\n  snaps: [],\n  weather: {\n    temperature: 0,\n    condition: ''\n  }\n};\n\nexport const getSnaps = createAsyncThunk(\n  'snapMap/snapsFetched',\n  async ({\n    lat,\n    lon,\n    city,\n    state\n  }: {\n    lat: number;\n    lon: number;\n    city: string;\n    state: string;\n  }) => {\n    const [error, response] = await api.get(`/snaps.json?geo=${lat},${lon}`);\n\n    if (error) return false;\n\n    // Set some dummy coordinates to make snaps seem close to user\n    const coords = [\n      {\n        lat: lat + 0.006,\n        lon: lon - 0.006\n      },\n      {\n        lat: lat + 0.009,\n        lon: lon + 0.005\n      },\n      {\n        lat: lat + 0.006,\n        lon: lon - 0.001\n      },\n      {\n        lat: lat - 0.005,\n        lon: lon - 0.002\n      },\n      {\n        lat: lat - 0.001,\n        lon: lon - 0.005\n      },\n      {\n        lat: lat + 0.005,\n        lon: lon - -0.006\n      },\n      {\n        lat: lat,\n        lon: lon + 0.004\n      }\n    ];\n\n    const snaps = response.snaps.map((snap, index) => ({\n      ...snap,\n      location: city && state ? `${city}, ${state}` : null,\n      lat: coords[index].lat,\n      lon: coords[index].lon\n    }));\n\n    return snaps;\n  }\n);\n\nexport const getWeather = createAsyncThunk(\n  'snapMap/weatherFetched',\n  async ({ lat, lon }: { lat: number; lon: number }) => {\n    const baseURL =\n      'https://cors-anywhere.herokuapp.com/https://www.metaweather.com/api/location';\n\n    // If fetching the user's actual weather fails below for some reason\n    // store this dummy data for purposes of the demo\n    let weather = {\n      temperature: 75,\n      condition: 'clear'\n    };\n\n    let [error, response] = await api.get(\n      `${baseURL}/search/?lattlong=${lat},${lon}`,\n      true\n    );\n\n    if (error) return false;\n\n    const whereOnEarthID = response[0]?.woeid;\n    [error, response] = await api.get(`${baseURL}/${whereOnEarthID}/`, true);\n\n    if (error) return false;\n\n    const { the_temp, weather_state_abbr } = response?.consolidated_weather[0];\n\n    weather = {\n      temperature: celsiusToFahrenheit(the_temp),\n      condition: abbrConditionMap[weather_state_abbr]\n    };\n\n    return weather;\n  }\n);\n\nconst snapMapSlice = createSlice({\n  name: 'snapMap',\n  initialState,\n  reducers: {},\n  extraReducers: (builder) => {\n    builder.addCase(getWeather.fulfilled, (state, { payload }) => {\n      if (payload) state.weather = payload;\n    });\n    builder.addCase(getSnaps.fulfilled, (state, { payload }) => {\n      if (payload) state.snaps = payload;\n    });\n  }\n});\n\nexport default snapMapSlice.reducer;\n","export const celsiusToFahrenheit = (celsius: number): number =>\n  Math.round(celsius * 1.8 + 32);\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { Snap } from './types';\n\nconst defaultSnap: Snap = {\n  type: '',\n  url: '',\n  location: '',\n  lat: 0,\n  lon: 0,\n  time: 0,\n  caption: '',\n  shareable: false\n};\n\nconst initialState: Snap = defaultSnap;\n\nconst snapSlice = createSlice({\n  name: 'snap',\n  initialState,\n  reducers: {\n    addSnap(state, { payload }: PayloadAction<Snap>) {\n      return payload;\n    },\n    removeSnap(state) {\n      return defaultSnap;\n    }\n  }\n});\n\nexport const { addSnap, removeSnap } = snapSlice.actions;\n\nexport default snapSlice.reducer;\n","import { createSlice, createAsyncThunk, PayloadAction } from '@reduxjs/toolkit';\nimport { v4 as uuid } from 'uuid';\nimport { api, loadable } from 'utils';\nimport { Loadable } from 'types';\nimport { Message } from './types';\n\nconst initialState: {\n  thread: string;\n  messages: Loadable<Message[]>;\n} = {\n  thread: 'Lisa',\n  messages: loadable\n};\n\nexport const getMessages = createAsyncThunk(\n  'chat/messagesReceived',\n  async (user: string) => {\n    const [error, response] = await api.get(`/messages.json?thread=${user}`);\n    if (error) return false;\n    return response.messages;\n  }\n);\n\nconst chatSlice = createSlice({\n  name: 'chat',\n  initialState,\n  reducers: {\n    postMessage: {\n      reducer(\n        state,\n        action: PayloadAction<{\n          id: string;\n          author: string;\n          message: string;\n          time: Date;\n        }>\n      ) {\n        const { id, author, message, time } = action.payload;\n        state.messages.data.push({\n          id,\n          author,\n          message,\n          time\n        });\n      },\n      prepare(author: string, message: string) {\n        return {\n          payload: {\n            id: uuid(),\n            author,\n            message,\n            time: new Date()\n          }\n        };\n      }\n    }\n  },\n  extraReducers: (builder) => {\n    builder.addCase(getMessages.pending, ({ messages }) => {\n      messages.loading = true;\n    });\n    builder.addCase(getMessages.fulfilled, ({ messages }, { payload }) => {\n      messages.loading = false;\n      if (payload) messages.data = payload;\n      else messages.error = true;\n    });\n    builder.addCase(getMessages.rejected, ({ messages }) => {\n      messages.loading = false;\n      messages.error = true;\n    });\n  }\n});\n\nexport const { postMessage } = chatSlice.actions;\n\nexport default chatSlice.reducer;\n","import React from 'react';\nimport classNames from 'classnames';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faSnapchatSquare, faGithub } from '@fortawesome/free-brands-svg-icons';\nimport { faCircle } from '@fortawesome/free-regular-svg-icons';\nimport {\n  faCamera,\n  faUserPlus,\n  faListAlt,\n  faGrinBeam,\n  faAngleRight,\n  faCompass,\n  faUserCircle,\n  faSearch,\n  faRetweet,\n  faAngleDown,\n  faLocationArrow,\n  faSignal,\n  faBatteryHalf,\n  faCommentAlt,\n  faMobile,\n  faMobileAlt,\n  faCircle as faDot,\n  faLaugh,\n  faSmileWink,\n  faEllipsisV,\n  faEllipsisH,\n  faCog,\n  faTimesCircle,\n  faTimes,\n  faAngleLeft,\n  faSearchPlus,\n  faPaw,\n  faSpider,\n  faWater,\n  faPhoneAlt,\n  faVideo,\n  faRocket,\n  faMicrophone,\n  faDownload,\n  faTextHeight,\n  faPen,\n  faStickyNote,\n  faCut,\n  faPaperclip,\n  faCropAlt,\n  faStopwatch,\n  faExternalLinkAlt,\n  faPlayCircle,\n  faEdit,\n  faMagic,\n  faQrcode,\n  faSnowflake,\n  faIcicles,\n  faCloudMeatball,\n  faPooStorm,\n  faCloudShowersHeavy,\n  faCloudRain,\n  faCloud,\n  faCloudSun,\n  faSun,\n  faExclamationCircle\n} from '@fortawesome/free-solid-svg-icons';\nimport './index.scss';\n\nexport const iconMap = {\n  // free-brands-svg-icons\n  faSnapchatSquare,\n  faGithub,\n  // free-regular-svg-icons\n  faCircle,\n  // free-solid-svg-icons\n  faCamera,\n  faUserPlus,\n  faListAlt,\n  faGrinBeam,\n  faAngleRight,\n  faCompass,\n  faUserCircle,\n  faSearch,\n  faRetweet,\n  faAngleDown,\n  faLocationArrow,\n  faSignal,\n  faBatteryHalf,\n  faCommentAlt,\n  faMobile,\n  faMobileAlt,\n  faDot,\n  faLaugh,\n  faSmileWink,\n  faEllipsisV,\n  faEllipsisH,\n  faCog,\n  faTimesCircle,\n  faTimes,\n  faAngleLeft,\n  faSearchPlus,\n  faPaw,\n  faSpider,\n  faWater,\n  faPhoneAlt,\n  faVideo,\n  faRocket,\n  faMicrophone,\n  faDownload,\n  faTextHeight,\n  faPen,\n  faStickyNote,\n  faCut,\n  faPaperclip,\n  faCropAlt,\n  faStopwatch,\n  faExternalLinkAlt,\n  faPlayCircle,\n  faEdit,\n  faMagic,\n  faQrcode,\n  faSnowflake,\n  faIcicles,\n  faCloudMeatball,\n  faPooStorm,\n  faCloudShowersHeavy,\n  faCloudRain,\n  faCloud,\n  faCloudSun,\n  faSun,\n  faExclamationCircle\n};\n\ninterface Props {\n  icon: string;\n  onClick?: () => void;\n  className?: string;\n}\n\nconst Icon: React.FC<Props> = ({ icon, onClick, className = '' }) =>\n  icon ? (\n    <FontAwesomeIcon\n      icon={iconMap[icon]}\n      onClick={onClick}\n      className={classNames('icon', {\n        [className]: true\n      })}\n    />\n  ) : null;\n\nexport default Icon;\n","import React from 'react';\nimport classNames from 'classnames';\nimport Icon from 'common/Icon';\nimport './index.scss';\n\ninterface Props {\n  image?: string;\n  icon?: string;\n  icons?: string[];\n  iconClass?: string;\n  iconClasses?: Array<string | null>;\n  buttonClass?: string;\n  round?: boolean;\n  plain?: boolean;\n  purple?: boolean;\n  label?: string;\n  onclick?: () => void;\n  testId?: string;\n}\n\nconst Button: React.FC<Props> = ({\n  image,\n  icon,\n  icons,\n  iconClass = '',\n  iconClasses = [],\n  buttonClass = '',\n  round,\n  plain,\n  purple,\n  label,\n  onclick,\n  testId\n}) => (\n  <button\n    type=\"button\"\n    onClick={onclick}\n    className={classNames('btn', {\n      [buttonClass]: true,\n      round,\n      plain,\n      purple\n    })}\n    data-test={testId}\n  >\n    {image ? (\n      <img src={image} alt=\"\" />\n    ) : icons ? (\n      icons.map((icon, index) => (\n        <Icon\n          key={icon + index}\n          icon={icon}\n          className={classNames({\n            [iconClasses[index] as string]: iconClasses[index]\n          })}\n        />\n      ))\n    ) : icon ? (\n      <Icon\n        icon={icon}\n        className={classNames({\n          [iconClass]: true\n        })}\n      />\n    ) : null}\n    {label && <strong>{label}</strong>}\n  </button>\n);\n\nexport default Button;\n","import React, { useRef, useState, useEffect } from 'react';\nimport classNames from 'classnames';\nimport { onAnimationComplete } from 'utils';\nimport Icon from 'common/Icon';\nimport './index.scss';\n\ninterface Props {\n  placeholder: string;\n  value?: string;\n  leftIcon?: string;\n  rightIcon?: string;\n  onClick?: () => void;\n  onFocus?: () => void;\n  onBlur?: () => void;\n  onChange?: (e: React.SyntheticEvent<HTMLInputElement>) => void;\n  onEnter?: () => void;\n  focus?: boolean;\n  spellCheck?: boolean;\n  animate?: boolean;\n  dark?: boolean;\n}\n\nconst Input: React.FC<Props> = ({\n  placeholder,\n  value,\n  leftIcon,\n  rightIcon,\n  onClick,\n  onFocus,\n  onBlur,\n  onChange,\n  onEnter,\n  focus,\n  spellCheck,\n  animate,\n  dark\n}) => {\n  const inputElem = useRef<HTMLInputElement>(null);\n  const [full, setFull] = useState(false);\n\n  useEffect(() => {\n    if (animate) setFull(true);\n    onAnimationComplete(() => {\n      if (focus) inputElem?.current?.focus();\n    });\n  }, [animate, focus]);\n\n  const disabled = onClick ? true : false;\n\n  return (\n    <div className={classNames('input', { animate, full, dark })} data-test=\"input\">\n      {disabled && <div className=\"disabled-overlay\" onClick={onClick} />}\n      {leftIcon && <Icon icon={leftIcon} className=\"left-icon\" />}\n      <input\n        type=\"text\"\n        ref={inputElem}\n        placeholder={placeholder}\n        value={value}\n        onClick={onClick}\n        onFocus={onFocus}\n        onBlur={onBlur}\n        onChange={onChange}\n        onKeyPress={({ key }) => onEnter && key === 'Enter' && onEnter()}\n        disabled={disabled}\n        spellCheck={spellCheck || false}\n        className={classNames({ 'has-left-icon': leftIcon })}\n        data-test=\"field\"\n      />\n      {rightIcon && <Icon icon={rightIcon} className=\"right-icon\" />}\n    </div>\n  );\n};\n\nexport default Input;\n","import React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { showDrawer } from 'AppShell/store';\nimport { toggleCameraMode } from 'features/Camera/store';\nimport Icon from 'common/Icon';\nimport Button from 'common/Button';\nimport Input from 'common/Input';\nimport './index.scss';\n\ninterface Props {\n  insideDrawer?: boolean;\n}\n\nconst Header: React.FC<Props> = ({ insideDrawer }) => {\n  const dispatch = useDispatch();\n  const avatar = useSelector(({ user }) => user.session.avatar);\n\n  const iconImage = avatar ? { image: avatar } : { icon: 'faUserCircle' };\n\n  return (\n    <header className=\"header\" data-test=\"header\">\n      <Button\n        {...iconImage}\n        onclick={() => dispatch(showDrawer({ component: 'account' }))}\n        buttonClass=\"btn-user\"\n        testId=\"btn-user\"\n      />\n      <Input\n        placeholder=\"Search\"\n        leftIcon=\"faSearch\"\n        rightIcon=\"faUserPlus\"\n        dark={insideDrawer}\n        onClick={() =>\n          dispatch(\n            showDrawer({\n              component: 'search',\n              animationIn: 'fadeIn',\n              animationOut: 'fadeOut',\n              animationInDuration: 200,\n              animationOutDuration: 200\n            })\n          )\n        }\n      />\n      <div className=\"right\">\n        {insideDrawer ? (\n          <Icon icon=\"faEllipsisH\" />\n        ) : (\n          <Button\n            icon=\"faRetweet\"\n            buttonClass=\"btn-flip-camera\"\n            onclick={() => dispatch(toggleCameraMode())}\n          />\n        )}\n      </div>\n    </header>\n  );\n};\n\nexport default Header;\n","import { Drawer } from './types';\n\nexport const atleastOneDrawerOpen = (drawers: Drawer[]): boolean =>\n  drawers.some(({ show }) => show);\n","import React, { useState, useEffect } from 'react';\nimport { useSelector } from 'react-redux';\nimport classNames from 'classnames';\nimport { language } from 'utils';\nimport { atleastOneDrawerOpen } from '../utils';\nimport Icon from 'common/Icon';\nimport './index.scss';\n\nconst Toolbar: React.FC = () => {\n  const drawers = useSelector(({ app }) => app.drawers);\n  const [time, setTime] = useState('');\n\n  const updateTime = () => {\n    const time = new Date()\n      .toLocaleTimeString(language, {\n        hour: 'numeric',\n        minute: '2-digit'\n      })\n      .replace(/AM|PM/, '');\n    setTime(time);\n  };\n\n  useEffect(() => {\n    updateTime();\n    setInterval(updateTime, 1000);\n  }, []);\n\n  return (\n    <div\n      className={classNames('toolbar', {\n        dark: atleastOneDrawerOpen(drawers)\n      })}\n    >\n      <div className=\"left\">\n        <time>{time}</time>\n        <Icon icon=\"faLocationArrow\" />\n      </div>\n      <div className=\"right\">\n        <Icon icon=\"faSignal\" className=\"icon-signal\" />\n        <Icon icon=\"faBatteryHalf\" />\n      </div>\n    </div>\n  );\n};\n\nexport default Toolbar;\n","import React from 'react';\nimport classNames from 'classnames';\nimport './index.scss';\n\ninterface Props {\n  header: string;\n  children: JSX.Element | JSX.Element[];\n  className?: string;\n  transparent?: boolean;\n}\n\nconst Widget: React.FC<Props> = ({ header, children, className = '', transparent }) => (\n  <section\n    className={classNames('widget', {\n      [className]: true\n    })}\n  >\n    <header>{header}</header>\n    <div className={classNames('inner-content', { transparent })}>{children}</div>\n  </section>\n);\n\nexport default Widget;\n","import React from 'react';\nimport classNames from 'classnames';\nimport Icon from 'common/Icon';\nimport Button from 'common/Button';\nimport './index.scss';\n\ninterface Props {\n  leftIcon: string;\n  rightIcon: string;\n  label: string;\n  straightEdge?: boolean;\n}\n\nconst ActionItem: React.FC<Props> = ({ leftIcon, rightIcon, label, straightEdge }) => (\n  <article\n    className={classNames('pod', 'action-item', {\n      'straight-edge': straightEdge\n    })}\n  >\n    <Icon icon={leftIcon} className=\"ico-left\" />\n    {label}\n    <Button icon={rightIcon} buttonClass=\"ico-right\" />\n  </article>\n);\n\nexport default ActionItem;\n","import React from 'react';\nimport classNames from 'classnames';\nimport './index.scss';\n\ninterface Props {\n  fixed?: boolean;\n  nobg?: boolean;\n  message?: string;\n}\n\nconst Loader: React.FC<Props> = ({ fixed, nobg, message }) => (\n  <div className={classNames('loading', { fixed, message, nobg })}>\n    <div className=\"center\">\n      <div className=\"sk-cube-grid\">\n        {new Array(9).fill(null).map((val, index) => (\n          <div key={`cube-${index}`} className={'sk-cube sk-cube' + index}></div>\n        ))}\n      </div>\n      {message && <span>{message}</span>}\n    </div>\n  </div>\n);\n\nexport default Loader;\n","import React, { useRef, useState, useEffect } from 'react';\nimport mapboxgl from 'mapbox-gl';\nimport { useDispatch } from 'react-redux';\nimport { showDrawer } from 'AppShell/store';\nimport { getGeoLocation, setLatLon } from 'features/User/store';\nimport Loader from 'common/Loader';\nimport './index.scss';\n\nconst apiKey = process.env.REACT_APP_MAP_BOX_API_KEY;\nconst hasApiKey = apiKey?.length ? true : false;\nif (hasApiKey) mapboxgl.accessToken = apiKey as string;\n\nconst Map: React.FC = () => {\n  const dispatch = useDispatch();\n  const mapElem = useRef<HTMLDivElement>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    if (!hasApiKey) return;\n\n    (async () => {\n      // Attempt to get the user's geo location via this endpoint `https://geolocation-db.com/json/` (IP based)\n      // if it fails ask the user for their location via the `navigator.geolocation` API (much slower)\n      const response = await dispatch(getGeoLocation());\n\n      if (response.payload) {\n        const { latitude, longitude } = response.payload;\n        loadMap(latitude, longitude);\n      } else {\n        const respond = (lat, lon) => {\n          loadMap(lat, lon);\n\n          dispatch(\n            setLatLon({\n              latitude: lat,\n              longitude: lon\n            })\n          );\n        };\n\n        // If the browser doesn't support geolocation or the call failed\n        // set a dummy location for purposes of the demo (Times Sq, NYC)\n        const dummyResponse = () => respond(40.75491, -73.994102);\n\n        if ('geolocation' in navigator) {\n          navigator.geolocation.getCurrentPosition(\n            ({ coords }) => {\n              respond(coords.latitude, coords.longitude);\n            },\n            (err) => {\n              dummyResponse();\n            },\n            {\n              maximumAge: Infinity,\n              timeout: 5000,\n              enableHighAccuracy: true\n            }\n          );\n        } else {\n          dummyResponse();\n        }\n      }\n    })();\n  }, [dispatch]);\n\n  const loadMap = (lat, lon) => {\n    const map = new mapboxgl.Map({\n      container: mapElem.current as HTMLDivElement,\n      style: 'mapbox://styles/mapbox/streets-v11',\n      center: [lon, lat],\n      zoom: 13,\n      interactive: false\n    }).on('load', () => {\n      setLoading(false);\n      // Add self marker\n      const tooltip = document.createElement('div');\n      tooltip.className = 'self-marker';\n      new mapboxgl.Marker(tooltip).setLngLat([lon, lat]).addTo(map);\n    });\n  };\n\n  return (\n    <div\n      className=\"preview-map\"\n      data-test=\"preview-map\"\n      onClick={() =>\n        hasApiKey &&\n        dispatch(\n          showDrawer({\n            component: 'snapMap',\n            animationIn: 'fadeIn',\n            animationOut: 'fadeOut',\n            animationInDuration: 0,\n            animationOutDuration: 0,\n            theme: 'stripped'\n          })\n        )\n      }\n    >\n      {!hasApiKey ? (\n        <div className=\"api-key-msg\">\n          <p>\n            <span role=\"img\" aria-label=\"earth emoji\">\n              🌎\n            </span>{' '}\n            Get a free mapboxgl{' '}\n            <a\n              href=\"https://docs.mapbox.com/help/glossary/access-token/\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n            >\n              API key here\n            </a>\n            , then rename the <code>.env.sample</code> file at the root of the project to\n            just <code>.env</code> and place the key inside, finally run\n            <code>npm start</code> again to view the snap map features!\n          </p>\n        </div>\n      ) : loading ? (\n        <Loader />\n      ) : null}\n\n      {hasApiKey && <div className=\"map\" ref={mapElem}></div>}\n    </div>\n  );\n};\n\nexport default Map;\n","import React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { hideDrawer } from 'AppShell/store';\nimport { language } from 'utils';\nimport Button from 'common/Button';\nimport Widget from 'common/Widget';\nimport ActionItem from 'common/Pod/ActionItem';\nimport Icon from 'common/Icon';\nimport Map from './Map';\nimport './index.scss';\n\nconst currentDate = new Date().toLocaleDateString(language, {\n  year: 'numeric',\n  month: 'long',\n  day: 'numeric'\n});\n\nconst Account: React.FC = () => {\n  const dispatch = useDispatch();\n  const username = useSelector(({ user }) => user.session.username);\n\n  return (\n    <main className=\"account\">\n      <header>\n        <Button\n          icon=\"faAngleDown\"\n          onclick={() => dispatch(hideDrawer('account'))}\n          buttonClass=\"btn-close\"\n        />\n        <Icon icon=\"faCog\" className=\"ico-gear\" />\n      </header>\n      <div className=\"logo\">\n        <img src=\"./images/logo.svg\" alt=\"\" />\n        <strong>{username}</strong>\n      </div>\n      <Widget header=\"Stories\" transparent>\n        <ActionItem leftIcon=\"faCamera\" rightIcon=\"faEllipsisV\" label=\"Add to My Story\" />\n        <ActionItem\n          leftIcon=\"faCamera\"\n          rightIcon=\"faEllipsisV\"\n          label=\"Add to Our Story\"\n        />\n      </Widget>\n      <Widget header=\"Friends\" transparent>\n        <ActionItem leftIcon=\"faUserPlus\" rightIcon=\"faAngleRight\" label=\"Add Friends\" />\n        <ActionItem leftIcon=\"faListAlt\" rightIcon=\"faAngleRight\" label=\"My Friends\" />\n      </Widget>\n      <Widget header=\"Bitmoji\" transparent>\n        <ActionItem\n          leftIcon=\"faGrinBeam\"\n          rightIcon=\"faAngleRight\"\n          label=\"Create Bitmoji\"\n        />\n      </Widget>\n      <Widget header=\"Snap Map\">\n        <Map />\n        <ActionItem\n          leftIcon=\"faCompass\"\n          rightIcon=\"faAngleRight\"\n          label=\"Set a Status\"\n          straightEdge\n        />\n      </Widget>\n      <footer>\n        <p>\n          <a\n            href=\"https://github.com/TowhidKashem/snapchat-clone\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            title=\"Github Repo\"\n          >\n            <Icon icon=\"faGithub\" />\n          </a>\n          Joined SnapChat on {currentDate}\n        </p>\n      </footer>\n    </main>\n  );\n};\n\nexport default Account;\n","import React from 'react';\nimport './index.scss';\n\nexport type sizeType = 'sm' | 'md' | 'lg';\n\ninterface Props {\n  src: string;\n  size?: sizeType;\n}\n\nexport const sizeMap = {\n  sm: 45,\n  md: 100,\n  lg: 150\n};\n\nconst Avatar: React.FC<Props> = ({ src, size = 'md' }) => (\n  <img src={src} className=\"avatar\" alt=\"\" width={sizeMap[size]} />\n);\n\nexport default Avatar;\n","import React from 'react';\nimport { User as UserInterface } from 'features/User/types';\nimport Avatar from 'common/Avatar';\nimport './index.scss';\n\ninterface Props {\n  user: UserInterface;\n}\n\nconst User: React.FC<Props> = ({ user: { username, fullName, avatar } }) => (\n  <article className=\"pod user\">\n    <Avatar src={avatar} size=\"sm\" />\n    <div className=\"meta\">\n      <header>{fullName}</header>\n      <span>{username}</span>\n    </div>\n  </article>\n);\n\nexport default User;\n","import React from 'react';\nimport Icon from 'common/Icon';\nimport './index.scss';\n\ninterface Props {\n  message?: string;\n}\n\nconst Error: React.FC<Props> = ({ message = \"Oops couldn't load content\" }) => (\n  <div className=\"error\">\n    <p>\n      <Icon icon=\"faExclamationCircle\" /> {message}\n    </p>\n  </div>\n);\n\nexport default Error;\n","import React, { useState, useEffect } from 'react';\nimport { Animated } from 'react-animated-css';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { hideDrawer } from 'AppShell/store';\nimport { escapeRegex } from 'utils';\nimport Input from 'common/Input';\nimport Button from 'common/Button';\nimport Widget from 'common/Widget';\nimport UserPod from 'common/Pod/User';\nimport Loader from 'common/Loader';\nimport Error from 'common/Error';\nimport './index.scss';\n\ninterface Props {\n  show: boolean;\n}\n\nconst Search: React.FC<Props> = ({ show }) => {\n  const dispatch = useDispatch();\n  const { loading, error, data } = useSelector(({ user }) => user.friends);\n  const [query, setQuery] = useState('');\n\n  useEffect(() => {\n    if (!show) setQuery('');\n  }, [show]);\n\n  const pattern = new RegExp(escapeRegex(query), 'gi');\n  const users = query\n    ? data.filter(\n        ({ fullName, username }) => fullName.match(pattern) || username.match(pattern)\n      )\n    : data;\n  const hasResults = users?.length > 0;\n\n  return (\n    <main className=\"search\">\n      <header>\n        <Input\n          placeholder=\"Search\"\n          leftIcon=\"faSearch\"\n          value={query}\n          onChange={(e) => setQuery(e.currentTarget.value)}\n          focus={show}\n          animate\n          dark\n        />\n        <Button\n          label=\"Cancel\"\n          plain\n          onclick={() => dispatch(hideDrawer('search'))}\n          testId=\"btn-cancel\"\n        />\n      </header>\n      <section>\n        {loading ? (\n          <Loader nobg />\n        ) : error ? (\n          <Error />\n        ) : (\n          <Animated\n            animationIn=\"slideInUp\"\n            animationOut=\"slideOutDown\"\n            animationInDuration={250}\n            animationOutDuration={0}\n            isVisible={show}\n          >\n            <div className=\"results\">\n              {hasResults && (\n                <Widget header=\"Quick Add\">\n                  {users.map((user) => (\n                    <UserPod key={user.id} user={user} />\n                  ))}\n                </Widget>\n              )}\n            </div>\n            {query && !hasResults && (\n              <p className=\"no-results\">\n                <span role=\"img\" aria-label=\"poop emoji\">\n                  💩\n                </span>{' '}\n                No results\n              </p>\n            )}\n          </Animated>\n        )}\n      </section>\n    </main>\n  );\n};\n\nexport default Search;\n","// Escape a user input string for use in a REGEX search\nexport const escapeRegex = (string: string) =>\n  string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n","import React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { hideDrawer } from 'AppShell/store';\nimport Button from 'common/Button';\nimport Icon from 'common/Icon';\nimport { conditionIconMap } from '../data';\nimport './index.scss';\n\nconst Header: React.FC = () => {\n  const dispatch = useDispatch();\n  const { city, weather } = useSelector(({ user, snapMap }) => ({\n    city: user.geolocation.city,\n    weather: snapMap.weather\n  }));\n  const { temperature, condition } = weather;\n\n  return (\n    <header className=\"weather-header\">\n      <div className=\"left\">\n        <Button\n          icon=\"faTimes\"\n          round\n          onclick={() => dispatch(hideDrawer('snapMap'))}\n          buttonClass=\"btn-close\"\n          testId=\"btn-close\"\n        />\n        <Button icon=\"faSearch\" round />\n      </div>\n      <div className=\"center\">\n        <article className=\"weather\">\n          <header>{city}</header>\n          <div className=\"condition\">\n            <Icon icon={conditionIconMap[condition]} />\n            <span className=\"temperature\">{temperature}&deg;F</span>\n          </div>\n        </article>\n      </div>\n      <div className=\"right\">\n        <Button icon=\"faCog\" round />\n      </div>\n    </header>\n  );\n};\n\nexport default Header;\n","import React, { useRef, useEffect, useState } from 'react';\nimport mapboxgl from 'mapbox-gl';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { showDrawer } from 'AppShell/store';\nimport { addSnap } from 'features/Snap/store';\nimport { getSnaps, getWeather } from './store';\nimport { Snap } from 'features/Snap/types';\nimport { onAnimationComplete } from 'utils';\nimport Loader from 'common/Loader';\nimport Header from './Header';\nimport './index.scss';\n\nmapboxgl.accessToken = process.env.REACT_APP_MAP_BOX_API_KEY as string;\n\nconst SnapMap: React.FC = () => {\n  const dispatch = useDispatch();\n  const { geolocation, snaps } = useSelector(({ user, snapMap }) => ({\n    geolocation: user.geolocation,\n    snaps: snapMap.snaps\n  }));\n\n  const mapElem = useRef<HTMLDivElement>(null);\n  const [loading, setLoading] = useState(true);\n  const [map, setMap] = useState<mapboxgl.Map | null>(null);\n\n  const { latitude, longitude, city, state } = geolocation;\n\n  useEffect(() => {\n    dispatch(getSnaps({ lat: latitude, lon: longitude, city, state }));\n    dispatch(getWeather({ lat: latitude, lon: longitude }));\n    setMap(\n      new mapboxgl.Map({\n        container: mapElem.current as HTMLDivElement,\n        style: 'mapbox://styles/mapbox/streets-v11',\n        center: [longitude, latitude],\n        zoom: 13\n      }).on('load', () => setLoading(false))\n    );\n  }, [dispatch, latitude, longitude, city, state]);\n\n  // Add self marker on map\n  useEffect(() => {\n    if (map) {\n      const addSelfMarker = () => {\n        const tooltip = document.createElement('div');\n        tooltip.className = 'self-marker';\n\n        new mapboxgl.Marker(tooltip).setLngLat([longitude, latitude]).addTo(map);\n\n        setTimeout(() => {\n          tooltip.classList.add('zoomed-in');\n\n          new mapboxgl.Popup({ closeOnClick: false })\n            .setLngLat([longitude, latitude])\n            .setHTML(\n              `<header>Me</header>\n              <p>Not Sharing Location</p>`\n            )\n            .addTo(map);\n        }, 2300);\n      };\n\n      addSelfMarker();\n\n      // Zoom in effect on load\n      setTimeout(() => map.flyTo({ zoom: 14 }), 2000);\n    }\n  }, [map, latitude, longitude]);\n\n  // Add snaps on map after they've loaded\n  useEffect(() => {\n    const addSnapToMap = (snap: Snap) => {\n      const marker = document.createElement('div');\n      marker.className = 'marker';\n      marker.setAttribute('data-test', 'marker');\n      marker.onclick = function (e: any) {\n        // Show pulse animation\n        e.target.classList.add('active');\n        // Delay opening the drawer so we can see the pulse\n        onAnimationComplete(() => {\n          dispatch(addSnap(snap));\n          dispatch(\n            showDrawer({\n              component: 'snap',\n              animationIn: 'zoomIn',\n              animationOut: 'zoomOut',\n              theme: 'dark'\n            })\n          );\n        }, 900);\n        // Remove pulse\n        onAnimationComplete(() => e.target.classList.remove('active'), 1000);\n      };\n      new mapboxgl.Marker(marker)\n        .setLngLat([snap.lon as number, snap.lat as number])\n        .addTo(map as mapboxgl.Map);\n    };\n\n    snaps.map((snap) => addSnapToMap(snap));\n  }, [snaps, map, dispatch]);\n\n  return (\n    <div className=\"snap-map\">\n      <div className=\"inner\">\n        {loading && <Loader />}\n        <Header />\n        <div ref={mapElem} className=\"content\"></div>\n      </div>\n    </div>\n  );\n};\n\nexport default SnapMap;\n","import React, { useEffect, useRef } from 'react';\nimport classNames from 'classnames';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { hideDrawer } from 'AppShell/store';\nimport { removeSnap } from './store';\nimport { onAnimationComplete, relativeTime } from 'utils';\nimport Button from 'common/Button';\nimport './index.scss';\n\nconst Snap: React.FC = () => {\n  const dispatch = useDispatch();\n  const snap = useSelector(({ snap }) => snap);\n  const videoElem = useRef<HTMLVideoElement>(null);\n\n  const { location, time, type, url, caption, shareable } = snap;\n\n  useEffect(() => {\n    if (type === 'video' && videoElem.current) {\n      videoElem.current.load();\n      videoElem.current.play();\n    }\n  }, [snap, type]);\n\n  const closeSnap = () => {\n    dispatch(hideDrawer('snap'));\n    onAnimationComplete(() => dispatch(removeSnap()));\n  };\n\n  return (\n    <main className=\"snap\" onClick={closeSnap} data-test=\"snap\">\n      <header className={classNames({ metadata: location || time })}>\n        {(location || time) && (\n          <div className=\"left\">\n            {location && <span data-test=\"location\">{location}</span>}\n            {time && <time data-test=\"time\">{relativeTime(time)}</time>}\n          </div>\n        )}\n        <div className=\"right\">\n          <Button icon=\"faEllipsisV\" />\n        </div>\n      </header>\n\n      {type === 'video' ? (\n        <div className=\"video-container\">\n          <video ref={videoElem} playsInline onEnded={closeSnap} data-test=\"video\">\n            <source src={url} type=\"video/mp4\" />\n          </video>\n        </div>\n      ) : (\n        <div className=\"image-container\" data-test=\"image\">\n          {caption && (\n            <div className=\"caption\" data-test=\"caption\">\n              {caption}\n            </div>\n          )}\n          <img src={url} alt=\"\" />\n        </div>\n      )}\n\n      {shareable && (\n        <footer>\n          <Button icon=\"faLocationArrow\" />\n        </footer>\n      )}\n    </main>\n  );\n};\n\nexport default Snap;\n","import { language } from './browser';\n\n// Pollyfill (mobile safari doesn't support `Intl.RelativeTimeFormat` at the moment)\nimport '@formatjs/intl-relativetimeformat/polyfill';\nimport '@formatjs/intl-relativetimeformat/polyfill-locales';\n\n// https://twitter.com/addyosmani/status/1261929447122513921/photo/1\nexport const relativeTime = (timestamp: number) => {\n  const formatter = new (Intl as any).RelativeTimeFormat(language, {\n    numeric: 'auto',\n    style: 'long'\n  });\n  const ms = timestamp - Date.now();\n  const years = Math.ceil(ms / 31536e6);\n  if (years) return formatter.format(years, 'year');\n  const months = Math.ceil(ms / 168e6);\n  if (months) return formatter.format(months, 'month');\n  const days = Math.ceil(ms / 864e5);\n  if (days) return formatter.format(days, 'day');\n  const hours = Math.ceil(ms / 36e5);\n  if (hours) return formatter.format(hours, 'hour');\n  const minutes = Math.ceil(ms / 6e4);\n  if (minutes) return formatter.format(minutes, 'minute');\n  const seconds = Math.ceil(ms / 1e3);\n  return formatter.format(seconds, 'second');\n};\n","import React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { showDrawer } from 'AppShell/store';\nimport { addSnap } from 'features/Snap/store';\nimport Header from 'common/Header';\nimport Button from 'common/Button';\nimport Loader from 'common/Loader';\nimport Error from 'common/Error';\nimport './index.scss';\n\nconst Archive: React.FC = () => {\n  const dispatch = useDispatch();\n  const { photos, photoTaken } = useSelector(({ camera }) => ({\n    photos: camera.photos,\n    photoTaken: camera.photoTaken\n  }));\n\n  const openPhoto = (image) => {\n    dispatch(\n      addSnap({\n        type: 'photo',\n        url: image,\n        shareable: true\n      })\n    );\n    dispatch(\n      showDrawer({\n        component: 'snap',\n        animationIn: 'zoomIn',\n        animationOut: 'zoomOut',\n        theme: 'dark'\n      })\n    );\n  };\n\n  return (\n    <main className=\"archive\">\n      <Header insideDrawer />\n\n      {photos.loading ? (\n        <Loader nobg />\n      ) : photos.error ? (\n        <Error />\n      ) : (\n        <>\n          <nav className=\"view-options\">\n            <Button label=\"Snaps\" buttonClass=\"active\" />\n            <Button label=\"Camera Roll\" />\n          </nav>\n\n          {!photoTaken && (\n            <section className=\"message\" data-test=\"placeholder-msg\">\n              <p>Take a photo and it will appear here!</p>\n            </section>\n          )}\n\n          {photos.data.map(({ month, year, images }) => (\n            <section key={month} className=\"month\" data-test=\"month\">\n              <h3>\n                {month} {year}\n              </h3>\n              {images.map((image, index) => (\n                <img\n                  key={image + index}\n                  src={image}\n                  width={100}\n                  alt=\"\"\n                  onClick={() => openPhoto(image)}\n                  data-test=\"snap-image\"\n                />\n              ))}\n            </section>\n          ))}\n        </>\n      )}\n    </main>\n  );\n};\n\nexport default Archive;\n","export const dummyMessages = [\n  \"Oh wow I can't believe it!\",\n  \"Hahaha you're so right!!\",\n  'No way, when?!! 😱',\n  'OMG I totally agree!',\n  \"Umm I'm not so sure about that one 🤨\",\n  'Wait, you are actually being serious rn?',\n  \"Hahahahaha you're too much 😂😂😂\",\n  'Did you watch the new show last night?',\n  '🤡'\n];\n","import React from 'react';\nimport Button from 'common/Button';\nimport './index.scss';\n\ninterface Props {\n  icons: string[];\n}\n\nconst Pill: React.FC<Props> = ({ icons }) => (\n  <div className=\"pill\">\n    {icons.map((icon) => (\n      <Button key={icon} icon={icon} />\n    ))}\n  </div>\n);\n\nexport default Pill;\n","import React, { useEffect, useLayoutEffect, useState, useRef, useCallback } from 'react';\nimport classNames from 'classnames';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { hideDrawer } from 'AppShell/store';\nimport { getMessages, postMessage } from './store';\nimport { dummyMessages } from './data';\nimport { randomArrayVal, playSound, sleep } from 'utils';\nimport Input from 'common/Input';\nimport Avatar from 'common/Avatar';\nimport Pill from 'common/Pill';\nimport Button from 'common/Button';\nimport Loader from 'common/Loader';\nimport Error from 'common/Error';\nimport './index.scss';\n\nconst Chat: React.FC = () => {\n  const dispatch = useDispatch();\n  const { username, thread, messages } = useSelector(({ user, chat }) => ({\n    username: user.session.username,\n    thread: chat.thread,\n    messages: chat.messages\n  }));\n\n  const messageContainer = useRef<HTMLElement>(null);\n  const audioElem = useRef<HTMLAudioElement>(null);\n\n  const [message, setMessage] = useState('');\n  const [typing, setTyping] = useState(false);\n\n  useLayoutEffect(() => {\n    // Scroll to bottom of container on load and each time a new message is posted\n    if (messageContainer.current)\n      messageContainer.current.scrollTop = messageContainer.current.scrollHeight;\n  }, [messages]);\n\n  const botResponse = useCallback(\n    async (firstMsg?: boolean) => {\n      // Pretend to type for a bit...\n      const typeAndStop = firstMsg ? [1000, 0] : [800, 500, 1000, 700, 600, 0];\n      for (let i = 0; i < typeAndStop.length; i++) {\n        setTyping((prevTyping) => !prevTyping);\n        await sleep(typeAndStop[i]);\n        continue;\n      }\n      const message = firstMsg ? 'Soooo, how was it!?' : randomArrayVal(dummyMessages);\n      dispatch(postMessage(thread, message));\n      if (audioElem.current) playSound('newAppMessage', audioElem.current);\n    },\n    [thread, dispatch]\n  );\n\n  useEffect(() => {\n    dispatch(getMessages(thread));\n    botResponse(true);\n  }, [thread, botResponse, dispatch]);\n\n  const submitMessage = () => {\n    if (!message.length) return;\n    dispatch(postMessage(username, message));\n    setMessage('');\n    setTimeout(botResponse, 1000);\n  };\n\n  return (\n    <main className=\"chat\">\n      <header>\n        <Avatar src=\"./images/bitmoji-other.png\" />\n        <h2>{thread}</h2>\n        <div className=\"right\">\n          <Pill icons={['faPhoneAlt', 'faVideo']} />\n          <Button\n            icon=\"faAngleRight\"\n            onclick={() => dispatch(hideDrawer('chat'))}\n            buttonClass=\"btn-arrow\"\n            testId=\"btn-close-chat\"\n          />\n        </div>\n      </header>\n\n      <section ref={messageContainer} className=\"messages\">\n        {messages.loading ? (\n          <Loader nobg />\n        ) : messages.error ? (\n          <Error />\n        ) : (\n          messages.data.map(({ author, message, time }, index) => (\n            <article\n              key={time + index}\n              className={classNames('message', {\n                other: author !== username\n              })}\n              data-test=\"message\"\n            >\n              <header>{author !== username ? author : 'Me'}</header>\n              <blockquote>{message}</blockquote>\n            </article>\n          ))\n        )}\n      </section>\n\n      <footer>\n        <div className={classNames('gravatar', { typing })}>\n          <Avatar src=\"./images/bitmoji-other.png\" />\n        </div>\n        <div className=\"inner-content\">\n          <Button icon=\"faCamera\" buttonClass=\"btn-camera\" round />\n          <Input\n            placeholder=\"Send a chat\"\n            rightIcon=\"faMicrophone\"\n            onChange={(e: React.SyntheticEvent<HTMLInputElement>) =>\n              setMessage(e.currentTarget.value)\n            }\n            onEnter={submitMessage}\n            onBlur={submitMessage}\n            value={message}\n          />\n          <div className=\"right\">\n            <Button icon=\"faSmileWink\" />\n            <Button icons={['faMobile', 'faMobileAlt']} buttonClass=\"btn-archive\" />\n            <Button icon=\"faRocket\" />\n          </div>\n        </div>\n      </footer>\n\n      <audio ref={audioElem} className=\"app-sound\"></audio>\n    </main>\n  );\n};\n\nexport default Chat;\n","export const randomArrayVal = (arr) => arr[Math.floor(Math.random() * arr.length)];\n","import React from 'react';\nimport './index.scss';\n\ninterface Props {\n  count?: number;\n}\n\nconst SkeletonFrame: React.FC<Props> = ({ count = 1 }) => (\n  <>\n    {new Array(count).fill(null).map((val, index) => (\n      <article key={`frame-${index}`} className=\"skeleton-frame\"></article>\n    ))}\n  </>\n);\n\nexport default SkeletonFrame;\n","import React from 'react';\nimport './index.scss';\n\ninterface Props {\n  title: string;\n  image: string;\n  testId?: string;\n}\n\nconst Spotlight: React.FC<Props> = ({ title, image, testId }) => (\n  <article className=\"pod spotlight\" data-test={testId}>\n    <img src={image} alt=\"\" />\n    <div className=\"meta\">\n      <header>{title}</header>\n    </div>\n  </article>\n);\n\nexport default Spotlight;\n","import React, { useEffect, useState, useRef } from 'react';\nimport { api, sleep, debounce, elemInView } from 'utils';\nimport Header from 'common/Header';\nimport Widget from 'common/Widget';\nimport Button from 'common/Button';\nimport SkeletonFrame from 'common/SkeletonFrame';\nimport SpotlightPod from 'common/Pod/Spotlight';\nimport { Profile } from './types';\nimport './index.scss';\n\ninterface Props {\n  drawerContent: any;\n}\n\nconst Discover: React.FC<Props> = ({ drawerContent }) => {\n  const loadMore = useRef(null);\n  const isFetching = useRef(false);\n  const onScroll = useRef(\n    debounce(() => {\n      if (!isFetching.current && elemInView(loadMore.current))\n        setPage((prevPage) => prevPage + 1);\n    }, 10)\n  );\n\n  const [page, setPage] = useState(1);\n  const [profiles, setProfiles] = useState<Profile[]>([]);\n\n  useEffect(() => {\n    drawerContent.current.addEventListener('scroll', onScroll.current);\n  }, [drawerContent]);\n\n  // Infinite scroll\n  useEffect(() => {\n    (async () => {\n      isFetching.current = true;\n      const [error, response] = await api.get(`/discover/page/${page}.json`);\n      if (!error) {\n        // Simulate slow API response on the first call to show off skeleton frames\n        if (page === 1) await sleep(1000);\n        setProfiles((prevProfiles) => [...prevProfiles, ...response.discover]);\n        isFetching.current = false;\n      }\n      if (page === 3)\n        drawerContent.current.removeEventListener('scroll', onScroll.current);\n    })();\n  }, [page, drawerContent]);\n\n  return (\n    <main className=\"discover\">\n      <Header insideDrawer />\n      <section className=\"view\">\n        <Widget className=\"friends\" header=\"Friends\" transparent>\n          <p>Stories from your friends will appear here.</p>\n          <Button label=\"Add Friends\" purple />\n        </Widget>\n        <Widget header=\"For You\" transparent>\n          <div className=\"inner\">\n            {profiles.length ? (\n              profiles.map(({ image, title }) => (\n                <SpotlightPod\n                  key={image}\n                  image={image}\n                  title={title}\n                  testId=\"discover-item\"\n                />\n              ))\n            ) : (\n              <SkeletonFrame count={10} />\n            )}\n          </div>\n        </Widget>\n        <div ref={loadMore} className=\"load-more\"></div>\n      </section>\n    </main>\n  );\n};\n\nexport default Discover;\n","// https://css-tricks.com/the-trick-to-viewport-units-on-mobile/\nexport const stretchViewPortHeight = (elem = document.documentElement) => {\n  const viewportHeight = window.innerHeight * 0.01;\n  elem.style.setProperty('--vh', viewportHeight + 'px');\n};\n\nexport const elemInView = (elem, fullyVisible?): boolean => {\n  const position = elem.getBoundingClientRect();\n  const elemTop = position.top;\n  const elemBottom = position.bottom;\n  const isVisible = fullyVisible\n    ? elemTop >= 0 && elemBottom <= window.innerHeight\n    : elemTop < window.innerHeight && elemBottom >= 0;\n  return isVisible;\n};\n","import React, { useRef } from 'react';\nimport { useSelector } from 'react-redux';\nimport classNames from 'classnames';\nimport { Animated } from 'react-animated-css';\nimport { onAnimationComplete } from 'utils';\nimport { AnimationType } from '../types';\nimport Account from 'features/Account';\nimport Search from 'features/Search';\nimport SnapMap from 'features/SnapMap';\nimport Snap from 'features/Snap';\nimport Archive from 'features/Archive';\nimport Chat from 'features/Chat';\nimport Discover from 'features/Discover';\nimport './index.scss';\n\nconst Drawer: React.FC = () => {\n  const drawers = useSelector(({ app }) => app.drawers);\n  const drawerContent = useRef(null);\n\n  const getComponent = (component, show) => {\n    const componentMap = {\n      account: <Account />,\n      search: <Search show={show} />,\n      snapMap: <SnapMap />,\n      snap: <Snap />,\n      archive: <Archive />,\n      chat: <Chat />,\n      discover: <Discover drawerContent={drawerContent} />\n    };\n    return componentMap[component];\n  };\n\n  return (\n    <>\n      {drawers &&\n        drawers.map(\n          ({\n            component,\n            animationIn,\n            animationOut,\n            animationInDuration,\n            animationOutDuration,\n            show,\n            theme,\n            position\n          }) => {\n            const elem = document.getElementById(component);\n            if (show) {\n              elem?.classList.remove('collapse');\n            } else {\n              onAnimationComplete(\n                () => elem?.classList.add('collapse'),\n                animationOutDuration\n              );\n            }\n\n            return (\n              <aside\n                id={component}\n                key={component}\n                className={classNames('drawer', {\n                  [theme as string]: true,\n                  [position as string]: true\n                })}\n              >\n                <div className=\"view\" data-test={`${component}-drawer`}>\n                  <Animated\n                    animationIn={animationIn as AnimationType}\n                    animationOut={animationOut as AnimationType}\n                    animationInDuration={animationInDuration}\n                    animationOutDuration={animationOutDuration}\n                    isVisible={show as boolean}\n                  >\n                    <section\n                      ref={drawerContent}\n                      className=\"content\"\n                      data-test=\"drawer-content\"\n                      style={{ height: window.innerHeight + 'px' }}\n                    >\n                      {getComponent(component, show)}\n                    </section>\n                  </Animated>\n                </div>\n              </aside>\n            );\n          }\n        )}\n    </>\n  );\n};\n\nexport default Drawer;\n","import React from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport classNames from 'classnames';\nimport { Animated } from 'react-animated-css';\nimport { showDrawer, hideAllDrawers, setFooterType } from 'AppShell/store';\nimport { atleastOneDrawerOpen } from '../utils';\nimport Button from 'common/Button';\nimport './index.scss';\n\nconst Footer: React.FC = () => {\n  const dispatch = useDispatch();\n  const { drawers, footerType } = useSelector(({ app }) => ({\n    drawers: app.drawers,\n    footerType: app.footerType\n  }));\n\n  return (\n    <>\n      {footerType !== 'none' && (\n        <footer\n          className={classNames('footer', {\n            'light-shadow': atleastOneDrawerOpen(drawers)\n          })}\n        >\n          <div className=\"left\">\n            <Button\n              icons={['faCommentAlt', 'faDot']}\n              iconClasses={[null, 'new-msg']}\n              buttonClass=\"btn-chat\"\n              testId=\"btn-chat\"\n              label=\"Chat\"\n              onclick={() =>\n                dispatch(\n                  showDrawer({\n                    component: 'chat',\n                    animationIn: 'slideInLeft',\n                    animationOut: 'slideOutLeft',\n                    theme: 'stripped'\n                  })\n                )\n              }\n            />\n          </div>\n          <div className=\"center\">\n            <Animated\n              animationIn=\"zoomIn\"\n              animationOut=\"zoomOut\"\n              animationInDuration={500}\n              animationOutDuration={500}\n              isVisible={footerType === 'collapsed'}\n              animateOnMount={false}\n            >\n              <Button\n                icon=\"faCircle\"\n                buttonClass=\"btn-capture\"\n                testId=\"btn-capture-footer\"\n                onclick={() => {\n                  dispatch(setFooterType('full'));\n                  dispatch(hideAllDrawers());\n                }}\n              />\n            </Animated>\n            <Animated\n              animationIn=\"zoomIn\"\n              animationOut=\"zoomOut\"\n              animationInDuration={500}\n              animationOutDuration={500}\n              isVisible={footerType === 'full'}\n              animateOnMount={false}\n            >\n              <Button\n                icons={['faMobile', 'faMobileAlt']}\n                buttonClass=\"btn-archive\"\n                testId=\"btn-archive\"\n                onclick={() => {\n                  dispatch(setFooterType('collapsed'));\n                  dispatch(\n                    showDrawer({\n                      component: 'archive',\n                      animationIn: 'slideInUp',\n                      animationOut: 'slideOutDown',\n                      position: 'back'\n                    })\n                  );\n                }}\n              />\n            </Animated>\n          </div>\n          <div className=\"right\">\n            <Button\n              icons={['faMobile', 'faMobile']}\n              buttonClass=\"btn-discover\"\n              testId=\"btn-discover\"\n              label=\"Discover\"\n              onclick={() => {\n                dispatch(setFooterType('collapsed'));\n                dispatch(\n                  showDrawer({\n                    component: 'discover',\n                    animationIn: 'slideInRight',\n                    animationOut: 'slideOutRight',\n                    position: 'back'\n                  })\n                );\n              }}\n            />\n          </div>\n        </footer>\n      )}\n    </>\n  );\n};\n\nexport default Footer;\n","import React, { useEffect } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { getSession, getFriends } from 'features/User/store';\nimport { getPhotos } from 'features/Camera/store';\nimport Header from 'common/Header';\nimport Toolbar from './Toolbar';\nimport Drawer from './Drawer';\nimport Footer from './Footer';\n\ninterface Props {\n  children: JSX.Element;\n}\n\nconst AppShell: React.FC<Props> = ({ children }) => {\n  const dispatch = useDispatch();\n\n  // Init the app\n  useEffect(() => {\n    dispatch(getSession());\n    dispatch(getFriends());\n    dispatch(getPhotos());\n  }, [dispatch]);\n\n  return (\n    <>\n      <Toolbar />\n      <Header />\n      <section className=\"view\">{children}</section>\n      <Drawer />\n      <Footer />\n    </>\n  );\n};\n\nexport default AppShell;\n","import React, { useRef, useEffect } from 'react';\nimport classNames from 'classnames';\nimport { useDispatch } from 'react-redux';\nimport { setPhoto } from '../store';\nimport { isIOS, stretchViewPortHeight } from 'utils';\nimport Button from 'common/Button';\nimport './index.scss';\n\ninterface Props {\n  takePic: boolean;\n  closePic: () => void;\n  videoElem: HTMLVideoElement;\n}\n\nconst PhotoCapture: React.FC<Props> = ({ takePic, closePic, videoElem }) => {\n  const dispatch = useDispatch();\n  const canvasElem = useRef<HTMLCanvasElement>(null);\n\n  useEffect(() => {\n    stretchViewPortHeight();\n  }, []);\n\n  const getDataURL = () => canvasElem?.current?.toDataURL('image/png') || '';\n\n  useEffect(() => {\n    const takePhoto = () => {\n      const { innerWidth, innerHeight } = window;\n      const context = canvasElem?.current?.getContext('2d');\n      if (context) {\n        context.canvas.width = innerWidth;\n        context.canvas.height = innerHeight;\n        context.drawImage(videoElem, 0, 0, innerWidth, innerHeight);\n      }\n    };\n    if (takePic) {\n      takePhoto();\n      dispatch(setPhoto(getDataURL()));\n    }\n  }, [takePic, videoElem, dispatch]);\n\n  const downloadPhoto = () => {\n    const dataURL = getDataURL();\n    if (isIOS()) {\n      window.open(dataURL, '_blank');\n    } else {\n      const link = document.createElement('a');\n      link.download = 'download.png';\n      link.href = dataURL;\n      link.click();\n    }\n  };\n\n  return (\n    <section\n      data-test=\"photo-capture\"\n      className={classNames('photo-capture', {\n        hide: !takePic\n      })}\n    >\n      <div className=\"inner\">\n        <header>\n          <Button icon=\"faTimes\" onclick={closePic} testId=\"btn-close\" />\n        </header>\n        <canvas ref={canvasElem}></canvas>\n        <aside>\n          <Button icon=\"faTextHeight\" />\n          <Button icon=\"faPen\" />\n          <Button icon=\"faStickyNote\" />\n          <Button icon=\"faCut\" />\n          <Button icon=\"faPaperclip\" />\n          <Button icon=\"faCropAlt\" />\n          <Button icon=\"faStopwatch\" />\n        </aside>\n        <footer>\n          <div className=\"left\">\n            <Button\n              icon=\"faDownload\"\n              label=\"Save\"\n              onclick={downloadPhoto}\n              buttonClass=\"btn-download\"\n            />\n            <Button icon=\"faExternalLinkAlt\" label=\"Story\" />\n          </div>\n          <div className=\"right\">\n            <Button icon=\"faPlayCircle\" label=\"Send To\" />\n          </div>\n        </footer>\n      </div>\n    </section>\n  );\n};\n\nexport default PhotoCapture;\n","import React, { useState, useRef, useEffect, useCallback } from 'react';\nimport classNames from 'classnames';\nimport { Animated } from 'react-animated-css';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { setFooterType } from 'AppShell/store';\nimport { Filter, FilterScript } from './types';\nimport { promise, playSound, onAnimationComplete } from 'utils';\nimport Button from 'common/Button';\nimport Loader from 'common/Loader';\nimport PhotoCapture from './PhotoCapture';\nimport './index.scss';\n\ndeclare global {\n  interface Window {\n    JEEFACEFILTERAPI: any;\n    Filters: FilterScript;\n  }\n}\n\nconst defaultFilters: Filter[] = ['dog', 'halloween', 'deform', 'bees', 'liberty'];\n\nconst Camera: React.FC = () => {\n  const dispatch = useDispatch();\n  const cameraMode = useSelector(({ camera }) => camera.cameraMode);\n\n  const videoElem = useRef<HTMLVideoElement>(null);\n  const audioElem = useRef<HTMLAudioElement>(null);\n\n  const [loading, setLoading] = useState(false);\n  const [showFilterButtons, setShowFilterButtons] = useState(false);\n  const [filters, setFilters] = useState<Filter[]>(defaultFilters);\n  const [activeFilter, setActiveFilter] = useState<Filter>('');\n  const [filterInitialized, setFilterInitialized] = useState(false);\n  const [cameraStream, setCameraStream] = useState(null);\n  const [takePic, setTakePic] = useState(false);\n  const [notSupported, setNotSupported] = useState(false);\n\n  const startCamera = useCallback(async () => {\n    const navigator: any = window.navigator;\n    const maxWidth = (document.querySelector('#wrapper') as HTMLDivElement)?.offsetWidth;\n\n    if (!('mediaDevices' in navigator)) navigator.mediaDevices = {};\n    if (!('getUserMedia' in navigator.mediaDevices)) {\n      navigator.mediaDevices.getUserMedia = (constraints) => {\n        const getUserMedia = navigator.webkitGetUserMedia || navigator.mozGetUserMedia;\n        if (!getUserMedia)\n          return Promise.reject(new Error('getUserMedia() is not implemented!'));\n        else\n          return new Promise((resolve, reject) =>\n            getUserMedia.call(navigator, constraints, resolve, reject)\n          );\n      };\n    }\n\n    const [error, response] = await promise(\n      navigator.mediaDevices.getUserMedia({\n        video: {\n          facingMode: cameraMode,\n          width: { ideal: maxWidth }\n        }\n      })\n    );\n\n    if (!error && videoElem.current) {\n      videoElem.current.srcObject = response;\n      setCameraStream(response);\n    } else {\n      setNotSupported(true);\n    }\n  }, [cameraMode]);\n\n  useEffect(() => {\n    startCamera();\n  }, [startCamera]);\n\n  useEffect(() => {\n    if (!activeFilter) return;\n\n    const stopCamera = () =>\n      (cameraStream as any).getTracks().forEach((track) => track.stop());\n\n    window.Filters[activeFilter].init(() => {\n      setFilterInitialized(true);\n      setLoading(false);\n      stopCamera();\n    });\n  }, [activeFilter, cameraStream]);\n\n  // Set the chosen filter at the center of the nav\n  const setActiveFilterButton = (selectFilter: Filter) => {\n    const newFilters = filters.filter((filter) => filter !== selectFilter);\n    newFilters.splice(2, 0, selectFilter);\n    setFilters(newFilters);\n  };\n\n  const switchFilter = async (selectFilter: Filter) => {\n    if (selectFilter === activeFilter) return;\n    setLoading(true);\n    setActiveFilterButton(selectFilter);\n    if (filterInitialized) {\n      const [error] = await promise(window.JEEFACEFILTERAPI.destroy());\n      if (!error) setActiveFilter(selectFilter);\n    } else {\n      setActiveFilter(selectFilter);\n    }\n  };\n\n  const showOpenMouth = (): boolean =>\n    !loading && ['dog', 'halloween'].includes(activeFilter);\n\n  return (\n    <main className=\"camera\">\n      {loading && <Loader message=\"Applying Filter\" fixed />}\n\n      {notSupported && (\n        <div className=\"not-supported\">\n          <p>\n            <span role=\"img\" aria-label=\"crying emoji\">\n              😭\n            </span>{' '}\n            Either your browser doesn't support the getUserMedia API used by the camera or\n            you declined camera access!\n          </p>\n        </div>\n      )}\n\n      <Animated\n        animationIn=\"tada\"\n        animationOut=\"fadeOut\"\n        animationInDuration={1000}\n        animationOutDuration={0}\n        isVisible={showOpenMouth()}\n        animateOnMount={false}\n      >\n        <div className=\"open-mouth\">\n          <strong>Open Mouth</strong>\n          <span role=\"img\" aria-label=\"tongue emoji\">\n            👅\n          </span>\n        </div>\n      </Animated>\n\n      <video\n        ref={videoElem}\n        muted\n        playsInline\n        autoPlay\n        className={classNames('video-stream', {\n          hide: filterInitialized || takePic\n        })}\n      ></video>\n\n      <PhotoCapture\n        takePic={takePic}\n        closePic={() => setTakePic(false)}\n        videoElem={videoElem.current as HTMLVideoElement}\n      />\n\n      <section className=\"controls\">\n        <Button\n          icon=\"faCircle\"\n          buttonClass=\"btn-capture\"\n          testId=\"btn-capture-main\"\n          onclick={() => {\n            if (notSupported) return;\n            setTakePic(true);\n            if (audioElem.current) playSound('cameraShutter', audioElem.current);\n          }}\n        />\n\n        {!showFilterButtons && (\n          <Button\n            icon=\"faLaugh\"\n            buttonClass=\"btn-filters\"\n            testId=\"btn-filters\"\n            onclick={() => {\n              if (notSupported) return;\n              setShowFilterButtons(true);\n              dispatch(setFooterType('none'));\n              // Load the center filter on the button list by default\n              onAnimationComplete(() => switchFilter(filters[2]), 100);\n            }}\n          />\n        )}\n\n        <Animated\n          animationIn=\"zoomIn\"\n          animationOut=\"zoomOut\"\n          animationInDuration={100}\n          animationOutDuration={100}\n          isVisible={showFilterButtons}\n          animateOnMount={false}\n        >\n          <div className=\"filters\" data-test=\"filters\">\n            {filters.map((filter) => (\n              <Button\n                key={filter}\n                image={`./images/filter-${filter}.svg`}\n                buttonClass={`filter-${filter}`}\n                onclick={() => switchFilter(filter)}\n              />\n            ))}\n          </div>\n\n          <div className=\"filter-actions\">\n            <Button icon=\"faMagic\" round />\n            <Button icon=\"faQrcode\" round />\n            <Button\n              icon=\"faTimesCircle\"\n              buttonClass=\"btn-close\"\n              onclick={() => {\n                setActiveFilter('');\n                setShowFilterButtons(false);\n                setFilterInitialized(false);\n                dispatch(setFooterType('full'));\n                startCamera();\n                window.JEEFACEFILTERAPI.destroy();\n              }}\n            />\n            <Button icon=\"faLaugh\" round />\n            <Button icon=\"faSearch\" round />\n          </div>\n        </Animated>\n      </section>\n\n      <audio ref={audioElem} className=\"app-sound\"></audio>\n    </main>\n  );\n};\n\nexport default Camera;\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport Icon from 'common/Icon';\nimport './index.scss';\n\nconst NotFound = () => (\n  <main className=\"not-found\">\n    <div className=\"message\">\n      <h1>Well, this is awkward!</h1>\n      <p>We couldn't find what you were looking for</p>\n      <Link to=\"/\">\n        <Icon icon=\"faSnapchatSquare\" />\n        <span>Go Home</span>\n      </Link>\n    </div>\n  </main>\n);\n\nexport default NotFound;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter as Router, Route, Switch } from 'react-router-dom';\nimport { configureStore } from '@reduxjs/toolkit';\nimport { Provider } from 'react-redux';\n\nimport app from 'AppShell/store';\nimport camera from 'features/Camera/store';\nimport user from 'features/User/store';\nimport snapMap from 'features/SnapMap/store';\nimport snap from 'features/Snap/store';\nimport chat from 'features/Chat/store';\n\nimport AppShell from 'AppShell';\nimport Camera from 'features/Camera';\nimport NotFound from 'features/404';\n\nimport 'normalize.css';\nimport 'animate.css';\nimport './styles/app.scss';\n\nexport const store = configureStore({\n  reducer: { app, camera, user, snapMap, snap, chat }\n});\n\nconst App = () => (\n  <React.StrictMode>\n    <Provider store={store}>\n      <Router>\n        <AppShell>\n          <Switch>\n            <Route path=\"/\" exact component={Camera} />\n            <Route path=\"/snapchat-clone\" exact component={Camera} />\n            <Route component={NotFound} />\n          </Switch>\n        </AppShell>\n      </Router>\n    </Provider>\n  </React.StrictMode>\n);\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}